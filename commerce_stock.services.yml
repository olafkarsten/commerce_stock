services:
  commerce_stock.availability_checker:
    class: Drupal\commerce_stock\StockAvailabilityChecker
    arguments: ['@commerce_stock.service_manager']
    tags:
      - { name: commerce.availability_checker, priority: 0 }

  commerce_stock.chain_stock_service_resolver:
    class: Drupal\commerce_stock\Resolver\ChainStockServiceResolver
    tags:
      - { name: service_collector, call: addResolver, tag: commerce_stock.stock_service_resolver }

  commerce_stock.default_stock_service_resolver:
    class: Drupal\commerce_stock\Resolver\DefaultStockServiceResolver
    arguments: ['@entity_type.manager', '@commerce_stock.chain_availability_location_resolver', '@commerce_stock.chain_transaction_location_resolver']
    tags:
      - { name: commerce_stock.stock_service_resolver, priority: -100 }

  commerce_stock.service_manager:
    class: Drupal\commerce_stock\StockServiceManager
    arguments: [ '@entity_type.manager', '@commerce_stock.chain_stock_service_resolver' ]

  commerce_stock.always_in_stock_service:
    class: Drupal\commerce_stock\AlwaysInStockService
    tags:
      - { name: commerce_stock.stock_service, priority: 0 }

  commerce_stock.order_event_subscriber:
    class: Drupal\commerce_stock\EventSubscriber\OrderEventSubscriber
    arguments: ['@commerce_stock.service_manager']
    tags:
      - { name: 'event_subscriber' }

  plugin.manager.stock_events:
    class: Drupal\commerce_stock\Plugin\StockEventsManager
    parent: default_plugin_manager

  commerce_stock.chain_transaction_location_resolver:
    class: Drupal\commerce_stock\Resolver\ChainTransactionLocationResolver
    tags:
      - { name: service_collector, call: addResolver, tag: commerce_stock.transaction_location_resolver }

  commerce_stock.chain_availability_location_resolver:
    class: Drupal\commerce_stock\Resolver\ChainAvailabilityLocationResolver
    tags:
      - { name: service_collector, call: addResolver, tag: commerce_stock.availability_location_resolver }
